train_images: "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/Datasets/crack500/dataset/train/images"
train_masks:  "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/Datasets/crack500/dataset/train/masks"
val_images:   "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/Datasets/crack500/dataset/val/images"
val_masks:    "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/Datasets/crack500/dataset/val/masks"
mask_prefix: "auto"
output_dir: "output_results_p4000"

# --- Preprocessing ---
preprocess: "random_crop" 
input_size: 512 # SOTA Standard for cracks
patches_per_image: 8 # Cover more area per epoch!

# --- SOTA Model Config (8GB VRAM Optimized) ---
encoder_name: "efficientnet-b0" # Lightweight SOTA backbone
encoder_weights: "imagenet"

# --- Training Strategy ---
batch_size: 8       # Fits in 8GB VRAM with AMP
grad_accum_steps: 2 # 8 * 2 = 16 (Effective Batch Size)
epochs: 500
seed: 42    

# --- Augmentation & Caching ---
aug_prob: 0.5 
cache_data: false # Too large for RAM
rotate_limit: 10
brightness_limit: 0.2
contrast_limit: 0.2

# --- Visualization ---
no_visualize: true
no_loss_curve: true
visualize_every: 0

# --- Loss Function ---
pos_weight: 1.0 # Dice Loss handles imbalance well enough
bce_weight: 0.25
dice_weight: 0.75

# --- Metrics ---
metric_threshold: 0.5
metric_thresholds: ""
scheduler_metric: "loss" # Ignored by Cosine

# --- Optimizer (AdamW) ---
learning_rate: 0.001 # Aggressive LR for fast convergence
weight_decay: 0.01 

# --- Scheduler (CosineAnnealingWarmRestarts) ---
scheduler_t0: 10
scheduler_tmult: 2

# --- Hardware Optimization ---
early_stop_patience: 100
num_workers: 8 # Balanced for System RAM
persistent_workers: true
pin_memory: true
prefetch_factor: 2
