train_images: "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/DamageDetector/crack500_crop/train/images"
train_masks:  "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/DamageDetector/crack500_crop/train/masks"
val_images:   "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/DamageDetector/crack500_crop/val/images"
val_masks:    "C:/Users/Dell Precision 7810/Desktop/quangvinh_workspace/DamageDetector/crack500_crop/val/masks"
mask_prefix: "auto"
output_dir: "output_results_p4000"

# --- Preprocessing ---
preprocess: "letterbox"
preprocess_train: "random_crop"
preprocess_val: "patch"
input_size: 512 # Optimal for ConvNeXt Tiny speed/memory
patches_per_image: 4

# --- SOTA Model Config (8GB VRAM Optimized) ---
encoder_name: "tu-convnext_tiny" 
encoder_weights: "imagenet"

# --- Training Strategy ---
batch_size: 8       
grad_accum_steps: 2 
epochs: 100
seed: 42    

# --- Augmentation & Caching ---
aug_prob: 0.5 
cache_data: false 
rotate_limit: 10
brightness_limit: 0.2
contrast_limit: 0.2

# --- Visualization ---
no_visualize: true
no_loss_curve: true
visualize_every: 0

# --- Loss Function ---
pos_weight: 2.0 # Fixed value to prevent massive False Positives (was "auto")
pos_weight_min: 2.0
pos_weight_max: 20.0
pos_weight_sample: 200
bce_weight: 1.0 # ENABLED
dice_weight: 0.5
focal_weight: 0.5
focal_alpha: 0.25
focal_gamma: 2.0

# --- Metrics ---
metric_threshold: 0.5
metric_thresholds: "0.2,0.3,0.4,0.5,0.6"
scheduler_metric: "loss" 

# --- Optimizer (AdamW) ---
learning_rate: 0.0001 # 1e-4: More stable with BCE+Dice+Focal
weight_decay: 0.01 

# --- Scheduler (CosineAnnealingWarmRestarts) ---
scheduler_t0: 10
scheduler_tmult: 2

# --- Hardware Optimization ---
early_stop_patience: 100
num_workers: 16
persistent_workers: true
pin_memory: true
prefetch_factor: 2
